import{j as e,m as L,A as se}from"./motion-CuGjFofd.js";import{a as xe,r as x,u as O,R as ue,b as _,N as me,c as he,B as pe}from"./vendor-Ctltn_FS.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();var q={},K=xe;q.createRoot=K.createRoot,q.hydrateRoot=K.hydrateRoot;const z={TELEGRAM:"telegram",WHATSAPP:"whatsapp",META5:"meta5"},re=x.createContext(),fe=({children:t})=>{const[s,n]=x.useState(z.TELEGRAM);return x.useEffect(()=>{Object.values(z).forEach(r=>document.body.classList.remove(`theme-${r}`)),document.body.classList.add(`theme-${s}`)},[s]),e.jsx(re.Provider,{value:{theme:s,setTheme:n},children:t})},ne=()=>x.useContext(re);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ie=(...t)=>t.filter((s,n,r)=>!!s&&s.trim()!==""&&r.indexOf(s)===n).join(" ").trim();/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var be={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=x.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:o="",children:i,iconNode:u,...b},l)=>x.createElement("svg",{ref:l,...be,width:s,height:s,stroke:t,strokeWidth:r?Number(n)*24/Number(s):n,className:ie("lucide",o),...b},[...u.map(([g,p])=>x.createElement(g,p)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=(t,s)=>{const n=x.forwardRef(({className:r,...o},i)=>x.createElement(ye,{ref:i,iconNode:s,className:ie(`lucide-${ge(t)}`,r),...o}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=k("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=k("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=k("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=k("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=k("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=k("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=k("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=k("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=k("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=k("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=k("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=k("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=k("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=k("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=k("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=k("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=k("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=k("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=k("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=k("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),W="https://behtarin-forex-backend.onrender.com/api";function le(){let t=localStorage.getItem("push_user_id");return t||(t="user_"+Math.random().toString(36).substr(2,9)+"_"+Date.now(),localStorage.setItem("push_user_id",t)),t}function V(){return"serviceWorker"in navigator&&"PushManager"in window}async function $e(){return V()?!!await(await navigator.serviceWorker.ready).pushManager.getSubscription():!1}async function Re(){return(await(await fetch(`${W}/push/vapid-public-key`)).json()).publicKey}function Me(t){const s="=".repeat((4-t.length%4)%4),n=(t+s).replace(/-/g,"+").replace(/_/g,"/"),r=window.atob(n),o=new Uint8Array(r.length);for(let i=0;i<r.length;++i)o[i]=r.charCodeAt(i);return o}async function ze(){if(!V())throw new Error("Push notifications are not supported");if(await Notification.requestPermission()!=="granted")throw new Error("Notification permission denied");const s=await navigator.serviceWorker.register("/sw.js");await navigator.serviceWorker.ready;const n=await Re(),r=Me(n),o=await s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:r}),i=le();if(!(await fetch(`${W}/push/subscribe`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription:o,userId:i})})).ok)throw new Error("Failed to subscribe on server");return console.log("âœ… Subscribed to push notifications"),!0}async function Ie(){if(!V())return;const s=await(await navigator.serviceWorker.ready).pushManager.getSubscription();s&&await s.unsubscribe();const n=le();return await fetch(`${W}/push/unsubscribe`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:n})}),console.log("âœ… Unsubscribed from push notifications"),!0}function De(){const[t,s]=x.useState(!1);return e.jsx(L.div,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},className:"mb-6",children:t?e.jsx("div",{className:"w-24 h-24 rounded-2xl shadow-lg bg-gradient-to-br from-green-500 to-green-600 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-3xl",children:"BF"})}):e.jsx("img",{src:"/logo.png",alt:"Behtarin Forex",className:"w-24 h-24 rounded-2xl shadow-lg object-cover",onError:()=>s(!0)})})}const Be=({theme:t,icon:s,label:n,description:r,color:o,onClick:i})=>e.jsxs(L.button,{whileTap:{scale:.98},onClick:()=>i(t),className:"w-full p-4 rounded-2xl bg-white/5 border border-white/10 flex items-center gap-4 active:bg-white/10 transition-all",children:[e.jsx("div",{className:`p-3 rounded-xl ${o==="blue"?"bg-blue-500/20":o==="green"?"bg-green-500/20":"bg-yellow-500/20"}`,children:e.jsx(s,{size:24,className:`${o==="blue"?"text-blue-400":o==="green"?"text-green-400":"text-yellow-400"}`})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"text-white font-semibold text-base",children:n}),e.jsx("div",{className:"text-gray-500 text-xs",children:r})]}),e.jsx(Ne,{size:20,className:"text-gray-600"})]});function _e(){const{setTheme:t}=ne(),s=O(),[n,r]=x.useState(!1),[o,i]=x.useState(!1),[u,b]=x.useState(!1);x.useEffect(()=>{(async()=>{const a=V();if(b(a),a){const y=await $e();r(y)}})()},[]);const l=c=>{t(c),s("/dashboard")},g=async()=>{i(!0);try{n?(await Ie(),r(!1)):(await ze(),r(!0))}catch(c){console.error("Notification error:",c),alert(c.message||"Ø®Ø·Ø§ Ø¯Ø± ØªÙ†Ø¸ÛŒÙ… Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†")}finally{i(!1)}},p=[{id:z.TELEGRAM,label:"Live Trade",description:"Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø²Ù†Ø¯Ù‡ - Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ",icon:H,color:"green"},{id:z.META5,label:"Signal Channel",description:"Ú©Ø§Ù†Ø§Ù„ Ø³ÛŒÚ¯Ù†Ø§Ù„ Ø¨Ù‡ØªØ±ÛŒÙ† ÙØ§Ø±Ú©Ø³",icon:D,color:"blue"}];return e.jsxs("div",{className:"min-h-screen bg-[#0e1621] flex flex-col pt-[env(safe-area-inset-top)]",children:[e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-6",children:[e.jsx(De,{}),e.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-center mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Behtarin Forex"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Ø¨Ù‡ØªØ±ÛŒÙ† ÙØ§Ø±Ú©Ø³"})]}),e.jsxs("div",{className:"w-full max-w-sm space-y-3",children:[p.map((c,a)=>e.jsx(L.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2+a*.1},children:e.jsx(Be,{theme:c.id,icon:c.icon,label:c.label,description:c.description,color:c.color,onClick:l})},c.id)),e.jsx(L.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4},children:e.jsxs("button",{onClick:u?g:()=>alert("Ø¨Ø±Ø§ÛŒ ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†ØŒ Ø§Ù¾ Ø±Ø§ Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯ (Add to Home Screen)"),disabled:o,className:`w-full p-4 rounded-2xl border flex items-center gap-3 transition-all ${n?"bg-green-500/10 border-green-500/30":u?"bg-white/5 border-white/10":"bg-orange-500/10 border-orange-500/30"}`,children:[e.jsx("div",{className:`p-3 rounded-xl flex-shrink-0 ${n?"bg-green-500/20":u?"bg-gray-500/20":"bg-orange-500/20"}`,children:o?e.jsx(I,{size:24,className:"text-gray-400 animate-spin"}):n?e.jsx(F,{size:24,className:"text-green-400"}):e.jsx(ve,{size:24,className:u?"text-gray-400":"text-orange-400"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"text-white font-semibold text-base",children:n?"Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† ÙØ¹Ø§Ù„":u?"Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† ØºÛŒØ±ÙØ¹Ø§Ù„":"Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†"}),e.jsx("div",{className:"text-gray-500 text-xs",children:n?"Ø¨Ø±Ø§ÛŒ ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯":u?"Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§ ÙØ¹Ø§Ù„ Ú©Ù†ÛŒØ¯":"Add to Home Screen Ø¨Ø±Ø§ÛŒ ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ"})]}),e.jsx("div",{className:`w-12 h-6 rounded-full transition-all flex-shrink-0 ${n?"bg-green-500":u?"bg-gray-600":"bg-orange-600"} relative`,children:e.jsx("div",{className:`absolute top-0.5 w-5 h-5 rounded-full bg-white transition-all duration-200 ${n?"right-0.5":"right-6"}`})})]})})]})]}),e.jsxs("div",{className:"p-6 pb-[max(1.5rem,env(safe-area-inset-bottom))] flex items-center justify-between",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"t.me/behtarinforex"}),e.jsx("button",{onClick:()=>s("/admin"),className:"p-2 rounded-lg hover:bg-white/5 transition",children:e.jsx(Le,{size:18,className:"text-gray-600"})})]})]})}const Fe="modulepreload",Oe=function(t){return"/"+t},Z={},Ve=function(s,n,r){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),b=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));o=Promise.allSettled(n.map(l=>{if(l=Oe(l),l in Z)return;Z[l]=!0;const g=l.endsWith(".css"),p=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${p}`))return;const c=document.createElement("link");if(c.rel=g?"stylesheet":Fe,g||(c.as="script"),c.crossOrigin="",c.href=l,b&&c.setAttribute("nonce",b),document.head.appendChild(c),g)return new Promise((a,y)=>{c.addEventListener("load",a),c.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(u){const b=new Event("vite:preloadError",{cancelable:!0});if(b.payload=u,window.dispatchEvent(b),!b.defaultPrevented)throw u}return o.then(u=>{for(const b of u||[])b.status==="rejected"&&i(b.reason);return s().catch(i)})},qe="https://behtarin-forex-backend.onrender.com/api".replace("/api","")||"http://localhost:5000";function ce(){const[t,s]=x.useState([]),[n,r]=x.useState(!1),[o,i]=x.useState(null);x.useEffect(()=>{let l=null;return(async()=>{try{const{io:p}=await Ve(async()=>{const{io:c}=await import("./index-wSuXe0Ee.js");return{io:c}},[]);l=p(qe,{transports:["websocket","polling"],reconnection:!0,reconnectionDelay:1e3,reconnectionAttempts:5}),l.on("connect",()=>{console.log("ðŸ”Œ Connected to trade server"),r(!0),l.emit("subscribe")}),l.on("disconnect",()=>{console.log("ðŸ”Œ Disconnected from trade server"),r(!1)}),l.on("trade_update",c=>{console.log("ðŸ“Š Trade update received:",c);const{event:a,data:y}=c,j={id:Date.now(),event:a,data:y,timestamp:new Date().toISOString()};s([j]),Ye(a)}),l.on("positions",c=>{console.log("ðŸ“Š Positions received:",c.length)}),i(l)}catch(p){console.error("Socket connection error:",p)}})(),()=>{l&&l.disconnect()}},[]);const u=x.useCallback(l=>{s(g=>g.filter(p=>p.id!==l))},[]),b=x.useCallback(()=>{s([])},[]);return{notifications:t,connected:n,dismissNotification:u,clearAll:b}}function Ye(t){try{const s=window.AudioContext||window.webkitAudioContext,n=new s,r=n.createOscillator(),o=n.createGain();r.connect(o),o.connect(n.destination),t==="position_opened"?(r.frequency.value=800,r.type="sine"):t==="position_closed"?(r.frequency.value=600,r.type="triangle"):(r.frequency.value=500,r.type="sine"),o.gain.setValueAtTime(.3,n.currentTime),o.gain.exponentialRampToValueAtTime(.01,n.currentTime+.3),r.start(n.currentTime),r.stop(n.currentTime+.3)}catch{}}const X="https://behtarin-forex-backend.onrender.com/api";async function He(){try{const t=await fetch(`${X}/trades/positions`);if(!t.ok)throw new Error("Failed to fetch positions");return await t.json()}catch(t){return console.error("API Error:",t),[]}}async function We(){try{const t=await fetch(`${X}/telegram/channel`);if(!t.ok)throw new Error("Failed to fetch channel info");return await t.json()}catch(t){return console.error("API Error:",t),null}}async function Xe(t=20){try{const s=await fetch(`${X}/telegram/messages?limit=${t}`);if(!s.ok)throw new Error("Failed to fetch messages");return(await s.json()).messages||[]}catch(s){return console.error("API Error:",s),[]}}function de(t){const s=(t==null?void 0:t.toUpperCase())||"";return s.includes("XAU")?.1:s.includes("JPY")?.01:1e-4}function Ge(t,s,n,r=60){const o=de(t);return(n==null?void 0:n.toUpperCase().includes("BUY"))?s-r*o:s+r*o}function Je(t,s,n,r=150){const o=de(t);return(n==null?void 0:n.toUpperCase().includes("BUY"))?s+r*o:s-r*o}function Ke(t){const s=(t==null?void 0:t.toUpperCase())||"";return s.includes("XAU")?2:s.includes("JPY")?3:5}function M(t,s){const n=Ke(t);return(s==null?void 0:s.toFixed(n))||"---"}function Ze(){const t=O(),{notifications:s}=ce(),[n,r]=x.useState(()=>{try{const a=localStorage.getItem("behtarin_signals");return a?JSON.parse(a):{}}catch{return{}}}),[o,i]=x.useState([]),u=x.useRef(null),b=x.useRef(new Set),l=x.useRef([]),g=x.useRef(new Map);x.useEffect(()=>{try{localStorage.setItem("behtarin_signals",JSON.stringify(n))}catch(a){console.error("Error saving signals:",a)}},[n]),x.useEffect(()=>{const a=async()=>{const j=await He();if(j){const N=new Map;j.forEach(h=>{var d,m;const f=h.magic||h.comment||((d=h.id)==null?void 0:d.toString().slice(-8));N.set(f,{fullId:((m=h.id)==null?void 0:m.toString())||"",volume:h.volume,profit:h.profit,price:h.currentPrice})}),j.forEach(h=>{var w,S;const f=h.magic||h.comment||((w=h.id)==null?void 0:w.toString().slice(-8)),d=((S=h.id)==null?void 0:S.toString())||"",m=g.current.get(f);if(m&&m.volume>h.volume+.001){const C=m.volume-h.volume,U=C.toFixed(2),v=h.volume,A=l.current.findIndex(P=>{const $=P.positionId===d||P.positionId.endsWith(f)||d.endsWith(P.positionId.slice(-8)),R=Math.abs(P.volume-C)<.005,B=Date.now()-P.timestamp<15e3;return $&&R&&B});let T,E;A!==-1?(T=l.current[A].profit,E=l.current[A].price,console.log("âœ… Using WebSocket profit:",T.toFixed(2)),l.current.splice(A,1)):(T=(m.volume>0?(m.profit||0)/m.volume:0)*C,E=h.currentPrice,console.log("âš ï¸ Using calculated profit:",T.toFixed(2),"(no matching deal found)")),console.log("Volume:",m.volume.toFixed(2),"â†’",h.volume.toFixed(2),"| Profit:",T.toFixed(2)),r(P=>P[f]?{...P,[f]:{...P[f],actions:[...P[f].actions||[],{type:"partial_close",closedVolume:U,remainingVolume:v.toFixed(2),profit:T,price:E,timestamp:new Date().toISOString()}]}}:P)}r(C=>C[f]?{...C,[f]:{...C[f],livePrice:h.currentPrice,liveProfit:h.profit,liveVolume:h.volume}}:C)}),g.current.size>0&&g.current.forEach((h,f)=>{if(!N.has(f)){console.log("Position fully closed:",f);const d=l.current.findIndex(S=>{const C=S.positionId.endsWith(f)||f.endsWith(S.positionId.slice(-8)),U=Date.now()-S.timestamp<15e3;return C&&U});let m=h.profit||0,w=h.price;d!==-1?(m=l.current[d].profit,w=l.current[d].price,console.log("âœ… Using WebSocket profit for close:",m.toFixed(2)),l.current.splice(d,1)):console.log("âš ï¸ Using last known profit for close:",m.toFixed(2)),r(S=>{var A;if(!S[f]||S[f].status==="closed")return S;const C=S[f].actions||[],U=C.reduce((T,E)=>T+(E.profit||0),0),v=U+m;return console.log("Total P/L calculation:",U.toFixed(2),"+",m.toFixed(2),"=",v.toFixed(2)),{...S,[f]:{...S[f],status:"closed",closePrice:w,closeProfit:v,closeTime:new Date().toISOString(),actions:[...C,{type:"closed",price:w,profit:m,volume:(A=h.volume)==null?void 0:A.toFixed(2),timestamp:new Date().toISOString()}]}}})}}),g.current=N,i(j)}};a();const y=setInterval(a,2e3);return()=>clearInterval(y)},[]),x.useEffect(()=>{var a,y,j,N,h,f,d,m,w,S,C,U;if(s.length>0){const v=s[0],A=`${v.event}-${(a=v.data)==null?void 0:a.id}-${v.timestamp}`;if(b.current.has(A))return;b.current.add(A);const T=((y=v.data)==null?void 0:y.magic)||((j=v.data)==null?void 0:j.comment)||((h=(N=v.data)==null?void 0:N.id)==null?void 0:h.toString().slice(-8))||"Unknown";if(v.event==="position_opened"){const E=(d=(f=v.data)==null?void 0:f.type)==null?void 0:d.includes("BUY");r(P=>{var $,R,B,G,J;return{...P,[T]:{id:T,symbol:($=v.data)==null?void 0:$.symbol,type:E?"buy":"sell",isBuy:E,openPrice:(R=v.data)==null?void 0:R.openPrice,volume:(B=v.data)==null?void 0:B.volume,openTime:v.timestamp,status:"active",actions:[],liveProfit:0,livePrice:(G=v.data)==null?void 0:G.openPrice,liveVolume:(J=v.data)==null?void 0:J.volume}}})}else if(v.event==="deal_closed"){const E=((w=(m=v.data)==null?void 0:m.positionId)==null?void 0:w.toString())||"",P=((S=v.data)==null?void 0:S.profit)||0,$=((C=v.data)==null?void 0:C.volume)||0,R=(U=v.data)==null?void 0:U.price;console.log("Deal closed:",{positionId:E,profit:P,volume:$}),l.current.push({positionId:E,profit:P,volume:$,price:R,timestamp:Date.now()}),l.current.length>20&&(l.current=l.current.slice(-20))}else v.event==="position_closed"&&console.log("Ignoring position_closed")}},[s]),x.useEffect(()=>{var a;(a=u.current)==null||a.scrollIntoView({behavior:"smooth"})},[n]);const p=o.map(a=>{var y,j;return{code:a.magic||a.comment||((y=a.id)==null?void 0:y.toString().slice(-8)),symbol:a.symbol,type:(j=a.type)!=null&&j.includes("BUY")?"BUY":"SELL",volume:a.volume,profit:a.profit}}),c=Object.values(n).sort((a,y)=>new Date(a.openTime)-new Date(y.openTime));return e.jsxs("div",{className:"h-screen flex flex-col bg-[#0e1621] safe-top",children:[e.jsxs("div",{className:"bg-[#17212b] text-white p-3 pt-[max(0.75rem,env(safe-area-inset-top))] flex items-center justify-between shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>t("/login"),className:"p-1 hover:bg-white/10 rounded-lg transition",children:e.jsx(Y,{size:22,className:"text-gray-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-[15px]",children:"ðŸ“Š Signal Tracker"}),e.jsxs("div",{className:"text-[11px] text-gray-400",children:[p.length," Ø³ÛŒÚ¯Ù†Ø§Ù„ ÙØ¹Ø§Ù„"]})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx(Pe,{size:20,className:"text-gray-400"})})]}),p.length>0&&e.jsx("div",{className:"bg-[#1c2733] px-3 py-2 flex gap-2 overflow-x-auto border-b border-[#0e1621]",children:p.map((a,y)=>{var j;return e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full text-xs whitespace-nowrap ${a.type==="BUY"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:[e.jsx("span",{className:"font-mono font-bold",children:a.code}),e.jsx("span",{children:a.symbol}),e.jsxs("span",{className:"text-gray-400",children:[a.volume,"lot"]}),e.jsxs("span",{className:a.profit>=0?"text-green-400":"text-red-400",children:[a.profit>=0?"+":"",(j=a.profit)==null?void 0:j.toFixed(1),"$"]})]},y)})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-[#182533] text-gray-400 text-[11px] px-3 py-1 rounded-full",children:"Ø§Ù…Ø±ÙˆØ²"})}),c.length===0&&e.jsx("div",{className:"flex justify-center mt-10",children:e.jsxs("div",{className:"bg-[#182533] text-gray-400 text-sm px-4 py-3 rounded-xl text-center",children:[e.jsx(F,{size:32,className:"mx-auto mb-2 opacity-50"}),e.jsx("div",{children:"Ù…Ù†ØªØ¸Ø± Ø³ÛŒÚ¯Ù†Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯..."})]})}),e.jsx(se,{children:c.map(a=>e.jsx(L.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},className:"flex justify-start",children:e.jsx(Qe,{signal:a})},a.id))}),e.jsx("div",{ref:u})]}),e.jsx("div",{className:"bg-[#17212b] border-t border-[#0e1621] p-3 pb-[max(0.75rem,env(safe-area-inset-bottom))]",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{children:"Ù…ØªØµÙ„ Ø¨Ù‡ MetaTrader"})]}),e.jsx("span",{children:"t.me/behtarinforex"})]})})]})}function Qe({signal:t}){const{id:s,symbol:n,type:r,isBuy:o,openPrice:i,volume:u,openTime:b,status:l,actions:g,liveProfit:p,livePrice:c,closeProfit:a}=t,y=d=>d!=null&&d.includes("XAU")?"Gold":d!=null&&d.includes("XAG")?"Silver":d,j=o?"bg-gradient-to-br from-green-900/40 to-green-800/20 border-green-500/30":"bg-gradient-to-br from-red-900/40 to-red-800/20 border-red-500/30",N=l==="closed"?a:p,h=N>=0,f=g&&g.length>0;return e.jsxs("div",{dir:"ltr",className:`w-[280px] rounded-2xl rounded-tl-md border ${j} overflow-hidden`,children:[e.jsx("div",{className:"px-3 py-2 border-b border-white/10",children:e.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap text-left",children:[e.jsx("span",{className:`text-base ${o?"text-green-500":"text-red-500"}`,children:o?"ðŸŸ¢":"ðŸ”´"}),e.jsx("span",{className:"text-white font-bold",children:y(n)}),e.jsx("span",{className:`font-bold text-sm ${o?"text-green-400":"text-red-400"}`,children:o?"Buy":"Sell"}),e.jsxs("span",{className:"text-gray-400 text-sm",children:["(",M(n,i),")"]}),e.jsxs("span",{className:"text-yellow-500 font-mono text-xs",children:["#",s]})]})}),e.jsxs("div",{className:"px-3 py-1.5 flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400 text-xs",children:"Volume"}),e.jsxs("span",{className:"font-mono text-white text-sm",children:[u," lot"]})]}),N!=null&&e.jsx("div",{className:"px-3 py-1.5 border-t border-white/5",children:e.jsxs("div",{className:`flex justify-between items-center px-2 py-1.5 rounded-lg ${h?"bg-green-500/20":"bg-red-500/20"}`,children:[e.jsx("span",{className:"text-gray-300 text-xs",children:"P/L"}),e.jsxs("span",{className:`font-mono font-bold ${h?"text-green-400":"text-red-400"}`,children:[h?"+":"",N==null?void 0:N.toFixed(2),"$"]})]})}),f&&e.jsx("div",{className:"border-t border-white/10",children:g.map((d,m)=>e.jsx(et,{action:d,symbol:n,signalCloseProfit:t.closeProfit},m))}),e.jsxs("div",{className:"px-3 py-1 flex justify-between items-center border-t border-white/5",children:[e.jsxs("span",{className:`text-[10px] ${l==="closed"?"text-gray-500":"text-green-400"}`,children:["â— ",l==="closed"?"Closed":"Active"]}),e.jsx("span",{className:"text-[10px] text-gray-500",children:new Date(b).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]})]})}function et({action:t,symbol:s,signalCloseProfit:n}){const{type:r,closedVolume:o,remainingVolume:i,profit:u,price:b,timestamp:l}=t,g=(u??0)>=0;if(r==="partial_close")return e.jsxs("div",{className:"px-3 py-2 bg-yellow-500/10 border-b border-yellow-500/20",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-yellow-400",children:"ðŸ“¦"}),e.jsx("span",{className:"text-gray-300",children:"Partial Close"})]}),e.jsx("span",{className:"text-gray-500 text-[10px]",children:new Date(l).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[e.jsxs("span",{className:"text-red-400",children:["-",o," lot"]}),e.jsx("span",{className:"text-gray-500",children:"â†’"}),e.jsxs("span",{className:"text-green-400",children:[i," lot"]})]}),e.jsxs("span",{className:`font-mono font-bold text-xs ${g?"text-green-400":"text-red-400"}`,children:[g?"+":"",u==null?void 0:u.toFixed(2),"$"]})]})]});if(r==="closed"){const p=n??u??0,c=p>=0;return e.jsxs("div",{className:"px-3 py-2 bg-gray-500/10 border-b border-gray-500/20",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-400",children:"âœ…"}),e.jsx("span",{className:"text-gray-300",children:"Fully Closed"}),e.jsxs("span",{className:"text-gray-500",children:["(",M(s,b),")"]})]}),e.jsx("span",{className:"text-gray-500 text-[10px]",children:new Date(l).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("div",{className:"flex items-center justify-end mt-1",children:e.jsxs("span",{className:`font-mono font-bold text-sm ${c?"text-green-400":"text-red-400"}`,children:["Total P/L: ",c?"+":"",p==null?void 0:p.toFixed(2),"$"]})})]})}return null}function tt({post:t,onReplyClick:s,isHighlighted:n}){const r=t.replyTo&&t.replyTo.text;return e.jsxs("div",{id:`msg-${t.id}`,className:`bg-[#182533] rounded-xl overflow-hidden transition-all duration-500 ${r?"border-l-4 border-l-blue-500 border border-blue-500/20":"border border-white/5"} ${n?"ring-2 ring-yellow-500 bg-yellow-500/10":""}`,children:[r&&e.jsxs("div",{className:"px-3 py-2 bg-blue-500/10 border-b border-blue-500/20 cursor-pointer hover:bg-blue-500/20 transition-colors active:bg-blue-500/30 flex items-start gap-2",onClick:()=>s(t.replyTo.id),children:[e.jsx(Ae,{size:14,className:"text-blue-400 rotate-180 flex-shrink-0 mt-1"}),e.jsx("div",{className:"flex-1 min-w-0 bg-[#0e1621] rounded px-2 py-1.5 border-l-2 border-blue-400",children:e.jsx("p",{className:"text-xs text-gray-400 line-clamp-4 leading-relaxed",dir:"auto",children:t.replyTo.text})}),e.jsx("span",{className:"text-[10px] text-blue-400 flex-shrink-0 mt-1",children:"â†©ï¸"})]}),e.jsx("div",{className:"p-4",children:e.jsx("pre",{className:"text-gray-200 text-sm whitespace-pre-wrap font-sans leading-relaxed",dir:"auto",children:t.text})}),(t.time||t.views)&&e.jsxs("div",{className:"px-4 py-2 border-t border-white/5 flex items-center justify-between text-xs text-gray-500",children:[e.jsx("span",{children:t.time}),t.views&&e.jsxs("span",{children:["ðŸ‘ ",t.views]})]})]})}function st(){const t=O(),[s,n]=x.useState([]),[r,o]=x.useState(null),[i,u]=x.useState(!0),[b,l]=x.useState(!1),[g,p]=x.useState(!1),[c,a]=x.useState(null),y=x.useRef(null),j=x.useRef(null),N=()=>{var m;(m=j.current)==null||m.scrollIntoView({behavior:"smooth"})},h=x.useCallback(m=>{if(!m)return;const w=document.getElementById(`msg-${m}`);w&&(w.scrollIntoView({behavior:"smooth",block:"center"}),a(m),setTimeout(()=>a(null),2e3))},[]),f=()=>{if(y.current){const{scrollTop:m,scrollHeight:w,clientHeight:S}=y.current;p(w-m-S>100)}},d=async(m=!1)=>{m?u(!0):l(!0);try{const[w,S]=await Promise.all([Xe(30),We()]);w&&w.length>0&&(n(w),m&&setTimeout(N,150)),S&&o(S)}catch(w){console.error("Error:",w)}finally{u(!1),l(!1)}};return x.useEffect(()=>{d(!0);const m=setInterval(()=>d(!1),5e3);return()=>clearInterval(m)},[]),e.jsxs("div",{className:"h-screen flex flex-col bg-[#0e1621] safe-top relative",children:[e.jsxs("div",{className:"bg-[#17212b] text-white p-3 pt-[max(0.75rem,env(safe-area-inset-top))] flex items-center justify-between shadow-lg z-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>t("/login"),className:"p-1 hover:bg-white/10 rounded-lg transition",children:e.jsx(Y,{size:22,className:"text-gray-400"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center",children:e.jsx(D,{size:18,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-[15px]",children:(r==null?void 0:r.title)||"Signal Channel"}),e.jsxs("div",{className:"text-[11px] text-gray-400 flex items-center gap-2",children:[e.jsxs("span",{children:["@",(r==null?void 0:r.username)||"behtarinforex"]}),(r==null?void 0:r.memberCount)>0&&e.jsxs("span",{className:"text-blue-400",children:["â€¢ ",r.memberCount.toLocaleString()," Ø¹Ø¶Ùˆ"]})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>d(!1),disabled:b,className:"p-2 hover:bg-white/10 rounded-full transition disabled:opacity-50",children:b?e.jsx(I,{size:18,className:"text-gray-400 animate-spin"}):e.jsx(Ee,{size:18,className:"text-gray-400"})}),e.jsx("a",{href:`https://t.me/${(r==null?void 0:r.username)||"behtarinforex"}`,target:"_blank",rel:"noopener noreferrer",className:"bg-blue-500 text-white text-xs px-3 py-1.5 rounded-full hover:bg-blue-600",children:"Join"})]})]}),e.jsx("div",{ref:y,onScroll:f,className:"flex-1 overflow-y-auto p-3 space-y-3",children:i?e.jsx("div",{className:"flex items-center justify-center py-10",children:e.jsx(I,{size:32,className:"text-blue-400 animate-spin"})}):s.length===0?e.jsx("div",{className:"text-center text-gray-500 py-10",children:"Ù‡ÛŒÚ† Ù¾ÛŒØ§Ù…ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-center py-2",children:e.jsx("a",{href:`https://t.me/${(r==null?void 0:r.username)||"behtarinforex"}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 text-xs hover:underline",children:"â† Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒâ€ŒØªØ± Ø¯Ø± ØªÙ„Ú¯Ø±Ø§Ù…"})}),s.map((m,w)=>e.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:w*.01},children:e.jsx(tt,{post:m,onReplyClick:h,isHighlighted:c===m.id})},m.id)),e.jsx("div",{ref:j})]})}),g&&e.jsx("button",{onClick:N,className:"absolute bottom-24 right-4 p-3 bg-[#17212b] border border-white/10 rounded-full shadow-lg hover:bg-[#1c2733] transition z-20",children:e.jsx(je,{size:20,className:"text-gray-400"})}),e.jsx("div",{className:"bg-[#17212b] border-t border-[#0e1621] p-3 pb-[max(0.75rem,env(safe-area-inset-bottom))]",children:e.jsxs("a",{href:`https://t.me/${(r==null?void 0:r.username)||"behtarinforex"}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl py-3 text-white font-medium",children:[e.jsx(D,{size:18}),e.jsx("span",{children:"Ø¹Ø¶ÙˆÛŒØª Ø¯Ø± Ú©Ø§Ù†Ø§Ù„"})]})})]})}function rt(){const{theme:t}=ne();return e.jsx("div",{className:"bg-[#0e1621] min-h-screen w-full flex justify-center items-start",children:e.jsxs("div",{className:"min-h-screen w-full max-w-lg mx-auto overflow-hidden bg-[#0e1621]",children:[t===z.TELEGRAM&&e.jsx(Ze,{}),t===z.META5&&e.jsx(st,{})]})})}const Q="https://behtarin-forex-backend.onrender.com/api";function nt(){const t=O(),[s,n]=x.useState("signal"),[r,o]=x.useState(""),[i,u]=x.useState(!1),[b,l]=x.useState(!1),[g,p]=x.useState(null),[c,a]=x.useState({symbol:"XAUUSD",tradeType:"buy",entries:"",stopLoss:"",targets:""}),[y,j]=x.useState(""),N=d=>{d.preventDefault(),r.length>0&&u(!0)},h=async()=>{l(!0),p(null);try{const m=await(await fetch(`${Q}/telegram/send-signal`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...c,password:r})})).json();m.success?(p({type:"success",text:"Ø³ÛŒÚ¯Ù†Ø§Ù„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯ âœ…"}),a({symbol:"XAUUSD",tradeType:"buy",entries:"",stopLoss:"",targets:""})):p({type:"error",text:m.error||"Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„"})}catch{p({type:"error",text:"Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±"})}finally{l(!1)}},f=async()=>{l(!0),p(null);try{const m=await(await fetch(`${Q}/telegram/send`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:y,password:r})})).json();m.success?(p({type:"success",text:"Ù¾ÛŒØ§Ù… Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯ âœ…"}),j("")):p({type:"error",text:m.error||"Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„"})}catch{p({type:"error",text:"Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±"})}finally{l(!1)}};return i?e.jsxs("div",{className:"min-h-screen bg-[#0e1621] safe-top",children:[e.jsx("div",{className:"bg-[#17212b] text-white p-3 pt-[max(0.75rem,env(safe-area-inset-top))] flex items-center justify-between shadow-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>t("/login"),className:"p-1 hover:bg-white/10 rounded-lg transition",children:e.jsx(Y,{size:22,className:"text-gray-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-[15px]",children:"ðŸ” Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª"}),e.jsx("div",{className:"text-[11px] text-gray-400",children:"Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø¨Ù‡ Ú©Ø§Ù†Ø§Ù„"})]})]})}),e.jsxs("div",{className:"flex border-b border-white/10",children:[e.jsxs("button",{onClick:()=>n("signal"),className:`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition ${s==="signal"?"text-blue-400 border-b-2 border-blue-400":"text-gray-500"}`,children:[e.jsx(Ue,{size:16})," Ø³ÛŒÚ¯Ù†Ø§Ù„"]}),e.jsxs("button",{onClick:()=>n("message"),className:`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition ${s==="message"?"text-blue-400 border-b-2 border-blue-400":"text-gray-500"}`,children:[e.jsx(Te,{size:16})," Ù¾ÛŒØ§Ù…"]})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[g&&e.jsxs(L.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:`p-3 rounded-xl flex items-center gap-2 ${g.type==="success"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:[g.type==="success"?e.jsx(we,{size:18}):e.jsx(ae,{size:18}),e.jsx("span",{className:"text-sm",children:g.text})]}),s==="signal"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-xs mb-1 block",children:"Ù†Ù…Ø§Ø¯"}),e.jsxs("select",{value:c.symbol,onChange:d=>a({...c,symbol:d.target.value}),className:"w-full bg-[#17212b] border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-blue-500",children:[e.jsx("option",{value:"XAUUSD",children:"XAUUSD (Ø·Ù„Ø§)"}),e.jsx("option",{value:"EURUSD",children:"EURUSD (ÛŒÙˆØ±Ùˆ/Ø¯Ù„Ø§Ø±)"}),e.jsx("option",{value:"GBPUSD",children:"GBPUSD (Ù¾ÙˆÙ†Ø¯/Ø¯Ù„Ø§Ø±)"}),e.jsx("option",{value:"XAGUSD",children:"XAGUSD (Ù†Ù‚Ø±Ù‡)"}),e.jsx("option",{value:"USDJPY",children:"USDJPY (Ø¯Ù„Ø§Ø±/ÛŒÙ†)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-xs mb-1 block",children:"Ù†ÙˆØ¹ Ù…Ø¹Ø§Ù…Ù„Ù‡"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>a({...c,tradeType:"buy"}),className:`flex-1 py-3 rounded-xl font-medium flex items-center justify-center gap-2 transition ${c.tradeType==="buy"?"bg-green-500 text-white":"bg-[#17212b] text-gray-400 border border-white/10"}`,children:[e.jsx(H,{size:18})," Ø®Ø±ÛŒØ¯ (BUY)"]}),e.jsxs("button",{onClick:()=>a({...c,tradeType:"sell"}),className:`flex-1 py-3 rounded-xl font-medium flex items-center justify-center gap-2 transition ${c.tradeType==="sell"?"bg-red-500 text-white":"bg-[#17212b] text-gray-400 border border-white/10"}`,children:[e.jsx(oe,{size:18})," ÙØ±ÙˆØ´ (SELL)"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-xs mb-1 block",children:"Ù†Ù‚Ø§Ø· ÙˆØ±ÙˆØ¯"}),e.jsx("input",{type:"text",value:c.entries,onChange:d=>a({...c,entries:d.target.value}),placeholder:"Ù…Ø«Ø§Ù„: 2650 Ùˆ 2648",className:"w-full bg-[#17212b] border border-white/10 rounded-xl px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-blue-500",dir:"ltr"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-xs mb-1 block",children:"Ø§Ø³ØªØ§Ù¾ Ù„Ø§Ø³"}),e.jsx("input",{type:"text",value:c.stopLoss,onChange:d=>a({...c,stopLoss:d.target.value}),placeholder:"Ù…Ø«Ø§Ù„: 2645",className:"w-full bg-[#17212b] border border-white/10 rounded-xl px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-blue-500",dir:"ltr"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-xs mb-1 block",children:"ØªØ§Ø±Ú¯Øªâ€ŒÙ‡Ø§ (Ø¨Ø§ Ú©Ø§Ù…Ø§ Ø¬Ø¯Ø§ Ú©Ù†ÛŒØ¯)"}),e.jsx("input",{type:"text",value:c.targets,onChange:d=>a({...c,targets:d.target.value}),placeholder:"Ù…Ø«Ø§Ù„: 2655, 2660, 2665, 2670",className:"w-full bg-[#17212b] border border-white/10 rounded-xl px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-blue-500",dir:"ltr"})]}),e.jsx("button",{onClick:h,disabled:b||!c.entries||!c.stopLoss||!c.targets,className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 disabled:opacity-50 text-white font-medium py-4 rounded-xl transition flex items-center justify-center gap-2",children:b?e.jsx(I,{size:20,className:"animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(D,{size:18})," Ø§Ø±Ø³Ø§Ù„ Ø³ÛŒÚ¯Ù†Ø§Ù„"]})})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-xs mb-1 block",children:"Ù…ØªÙ† Ù¾ÛŒØ§Ù…"}),e.jsx("textarea",{value:y,onChange:d=>j(d.target.value),placeholder:"Ù…ØªÙ† Ù¾ÛŒØ§Ù… Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯...",rows:6,className:"w-full bg-[#17212b] border border-white/10 rounded-xl px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-blue-500 resize-none",dir:"rtl"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-xs mb-2 block",children:"Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø³Ø±ÛŒØ¹"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["âœ… ØªØ§Ø±Ú¯Øª Û± Ø²Ø¯Ù‡ Ø´Ø¯!","âœ… ØªØ§Ø±Ú¯Øª Û² Ø²Ø¯Ù‡ Ø´Ø¯!","âŒ Ø§Ø³ØªØ§Ù¾ Ø²Ø¯Ù‡ Ø´Ø¯","ðŸ“Š Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ø§Ø²Ø§Ø±...","ðŸ”’ Ø§Ø³ØªØ§Ù¾ Ø¨Ù‡ ÙˆØ±ÙˆØ¯ Ù…Ù†ØªÙ‚Ù„ Ø´Ø¯"].map(d=>e.jsx("button",{onClick:()=>j(y+(y?`
`:"")+d),className:"px-3 py-1.5 bg-[#17212b] border border-white/10 rounded-lg text-xs text-gray-300 hover:bg-white/5",children:d},d))})]}),e.jsx("button",{onClick:f,disabled:b||!y.trim(),className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 disabled:opacity-50 text-white font-medium py-4 rounded-xl transition flex items-center justify-center gap-2",children:b?e.jsx(I,{size:20,className:"animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(D,{size:18})," Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù…"]})})]})]})]}):e.jsx("div",{className:"min-h-screen bg-[#0e1621] flex flex-col items-center justify-center p-6",children:e.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-sm",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-500/20 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(Ce,{size:32,className:"text-blue-400"})}),e.jsx("h1",{className:"text-white text-xl font-bold",children:"Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯"})]}),e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsx("input",{type:"password",value:r,onChange:d=>o(d.target.value),placeholder:"Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±",className:"w-full bg-[#17212b] border border-white/10 rounded-xl px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-blue-500",dir:"ltr"}),e.jsx("button",{type:"submit",className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-medium py-3 rounded-xl transition",children:"ÙˆØ±ÙˆØ¯"})]}),e.jsx("button",{onClick:()=>t("/login"),className:"w-full mt-4 text-gray-500 text-sm hover:text-gray-400",children:"Ø¨Ø§Ø²Ú¯Ø´Øª"})]})})}const ee=60,te=150;function it({notifications:t,onDismiss:s}){return e.jsx("div",{className:"fixed top-4 right-4 z-[100] space-y-2 max-w-sm w-full pointer-events-none",children:e.jsx(se,{children:t.map(n=>e.jsx(L.div,{initial:{opacity:0,x:100,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:100,scale:.8},className:"pointer-events-auto",children:e.jsx(ot,{notification:n,onDismiss:s})},n.id))})})}function ot({notification:t,onDismiss:s}){var N,h;const{id:n,type:r,event:o,data:i,timestamp:u}=t,l=(()=>{var f,d;switch(o){case"position_opened":return{icon:(f=i.type)!=null&&f.includes("BUY")?H:oe,color:(d=i.type)!=null&&d.includes("BUY")?"green":"red",title:"ðŸš€ Ù…Ø¹Ø§Ù…Ù„Ù‡ Ø¬Ø¯ÛŒØ¯ Ø¨Ø§Ø² Ø´Ø¯!",titleEn:"New Position Opened!"};case"position_closed":return{icon:ke,color:i.profit>=0?"green":"red",title:i.profit>=0?"âœ… Ù…Ø¹Ø§Ù…Ù„Ù‡ Ø¨Ø§ Ø³ÙˆØ¯ Ø¨Ø³ØªÙ‡ Ø´Ø¯!":"âŒ Ù…Ø¹Ø§Ù…Ù„Ù‡ Ø¨Ø§ Ø¶Ø±Ø± Ø¨Ø³ØªÙ‡ Ø´Ø¯!",titleEn:i.profit>=0?"Position Closed (Profit)":"Position Closed (Loss)"};case"position_updated":return{icon:Se,color:"yellow",title:"ðŸ“ Ù…Ø¹Ø§Ù…Ù„Ù‡ Ø¢Ù¾Ø¯ÛŒØª Ø´Ø¯",titleEn:"Position Updated"};case"order_placed":return{icon:F,color:"blue",title:"ðŸ“‹ Ø³ÙØ§Ø±Ø´ Ø«Ø¨Øª Ø´Ø¯",titleEn:"Order Placed"};default:return{icon:F,color:"gray",title:"Trade Update",titleEn:"Trade Update"}}})(),g=l.icon,p=(N=i.type)==null?void 0:N.includes("BUY"),c=parseFloat(i.openPrice)||0,a=i.stopLoss||Ge(i.symbol,c,i.type,ee),y=i.takeProfit||Je(i.symbol,c,i.type,te),j={green:"bg-green-500/10 border-green-500/30 text-green-500",red:"bg-red-500/10 border-red-500/30 text-red-500",yellow:"bg-yellow-500/10 border-yellow-500/30 text-yellow-500",blue:"bg-blue-500/10 border-blue-500/30 text-blue-500",gray:"bg-gray-500/10 border-gray-500/30 text-gray-500"};return e.jsxs("div",{className:`bg-[#1a1a1a] border ${j[l.color].split(" ")[1]} rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg`,children:[e.jsxs("div",{className:`px-4 py-2 flex items-center justify-between ${j[l.color].split(" ")[0]}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{size:18,className:j[l.color].split(" ")[2]}),e.jsx("span",{className:"font-bold text-sm text-white",children:l.title})]}),e.jsx("button",{onClick:()=>s(n),className:"p-1 hover:bg-white/10 rounded transition",children:e.jsx(ae,{size:14,className:"text-gray-400"})})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-xl text-white",children:i.symbol}),e.jsx("span",{className:`text-xs font-bold px-2 py-0.5 rounded ${p?"bg-green-500/20 text-green-500":"bg-red-500/20 text-red-500"}`,children:p?"BUY":"SELL"})]}),i.volume&&e.jsxs("span",{className:"text-sm text-gray-400 font-mono",children:[i.volume," lot"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-black/40 rounded-lg p-2 border border-white/10",children:[e.jsx("div",{className:"text-gray-400 text-[10px] uppercase mb-1",children:"Entry"}),e.jsx("div",{className:"font-mono text-white font-bold",children:M(i.symbol,c)})]}),e.jsxs("div",{className:"bg-red-500/10 rounded-lg p-2 border border-red-500/20",children:[e.jsxs("div",{className:"text-red-400 text-[10px] uppercase mb-1 flex items-center justify-between",children:[e.jsx("span",{children:"SL"}),e.jsxs("span",{className:"text-[8px] text-red-300",children:[ee," pip"]})]}),e.jsx("div",{className:"font-mono text-red-400 font-bold",children:M(i.symbol,a)})]}),e.jsxs("div",{className:"bg-green-500/10 rounded-lg p-2 border border-green-500/20",children:[e.jsxs("div",{className:"text-green-400 text-[10px] uppercase mb-1 flex items-center justify-between",children:[e.jsx("span",{children:"TP"}),e.jsxs("span",{className:"text-[8px] text-green-300",children:[te," pip"]})]}),e.jsx("div",{className:"font-mono text-green-400 font-bold",children:M(i.symbol,y)})]})]}),i.profit!==void 0&&e.jsxs("div",{className:`text-center py-2 rounded-lg ${i.profit>=0?"bg-green-500/20":"bg-red-500/20"}`,children:[i.currentPrice&&e.jsxs("div",{className:"text-xs text-gray-400 mb-1",children:["Current: ",e.jsx("span",{className:"text-yellow-500 font-mono",children:M(i.symbol,i.currentPrice)})]}),e.jsxs("span",{className:`font-mono font-bold text-lg ${i.profit>=0?"text-green-500":"text-red-500"}`,children:[i.profit>=0?"+":"",(h=i.profit)==null?void 0:h.toFixed(2),"$"]})]}),e.jsx("div",{className:"text-[10px] text-gray-500 text-right",children:new Date(u).toLocaleTimeString("fa-IR")})]})]})}function at(){const{notifications:t,connected:s,dismissNotification:n}=ce();return e.jsxs("div",{className:"antialiased",children:[e.jsx(it,{notifications:t,onDismiss:n}),s&&e.jsxs("div",{className:"fixed bottom-4 left-4 z-50 flex items-center gap-2 bg-green-500/20 text-green-500 text-xs px-3 py-1.5 rounded-full border border-green-500/30",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Live Connected"]}),e.jsxs(ue,{children:[e.jsx(_,{path:"/login",element:e.jsx(_e,{})}),e.jsx(_,{path:"/dashboard",element:e.jsx(rt,{})}),e.jsx(_,{path:"/admin",element:e.jsx(nt,{})}),e.jsx(_,{path:"*",element:e.jsx(me,{to:"/login",replace:!0})})]})]})}function lt(){return e.jsx(fe,{children:e.jsx(at,{})})}q.createRoot(document.getElementById("root")).render(e.jsx(he.StrictMode,{children:e.jsx(pe,{children:e.jsx(lt,{})})}));
