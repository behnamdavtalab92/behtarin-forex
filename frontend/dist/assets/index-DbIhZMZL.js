import{j as e,m as U,A as ne}from"./motion-CuGjFofd.js";import{a as me,r as u,u as V,R as he,b as F,N as pe,c as fe,B as ge}from"./vendor-Ctltn_FS.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const m of i.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&r(m)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var Y={},Z=me;Y.createRoot=Z.createRoot,Y.hydrateRoot=Z.hydrateRoot;const I={TELEGRAM:"telegram",WHATSAPP:"whatsapp",META5:"meta5"},ie=u.createContext(),be=({children:t})=>{const[s,n]=u.useState(I.TELEGRAM);return u.useEffect(()=>{Object.values(I).forEach(r=>document.body.classList.remove(`theme-${r}`)),document.body.classList.add(`theme-${s}`)},[s]),e.jsx(ie.Provider,{value:{theme:s,setTheme:n},children:t})},oe=()=>u.useContext(ie);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ae=(...t)=>t.filter((s,n,r)=>!!s&&s.trim()!==""&&r.indexOf(s)===n).join(" ").trim();/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var je={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=u.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:a="",children:i,iconNode:m,...y},d)=>u.createElement("svg",{ref:d,...je,width:s,height:s,stroke:t,strokeWidth:r?Number(n)*24/Number(s):n,className:ae("lucide",a),...y},[...m.map(([g,f])=>u.createElement(g,f)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=(t,s)=>{const n=u.forwardRef(({className:r,...a},i)=>u.createElement(ve,{ref:i,iconNode:s,className:ae(`lucide-${ye(t)}`,r),...a}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=S("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=S("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=S("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=S("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=S("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=S("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=S("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=S("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=S("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=S("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=S("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=S("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=S("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=S("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=S("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=S("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=S("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=S("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=S("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=S("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),X="https://behtarin-forex-backend.onrender.com/api";function de(){let t=localStorage.getItem("push_user_id");return t||(t="user_"+Math.random().toString(36).substr(2,9)+"_"+Date.now(),localStorage.setItem("push_user_id",t)),t}function q(){return"serviceWorker"in navigator&&"PushManager"in window}async function Me(){return q()?!!await(await navigator.serviceWorker.ready).pushManager.getSubscription():!1}async function ze(){return(await(await fetch(`${X}/push/vapid-public-key`)).json()).publicKey}function Ie(t){const s="=".repeat((4-t.length%4)%4),n=(t+s).replace(/-/g,"+").replace(/_/g,"/"),r=window.atob(n),a=new Uint8Array(r.length);for(let i=0;i<r.length;++i)a[i]=r.charCodeAt(i);return a}async function Be(){if(!q())throw new Error("Push notifications are not supported");if(await Notification.requestPermission()!=="granted")throw new Error("Notification permission denied");const s=await navigator.serviceWorker.register("/sw.js");await navigator.serviceWorker.ready;const n=await ze(),r=Ie(n),a=await s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:r}),i=de();if(!(await fetch(`${X}/push/subscribe`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription:a,userId:i})})).ok)throw new Error("Failed to subscribe on server");return console.log("âœ… Subscribed to push notifications"),!0}async function De(){if(!q())return;const s=await(await navigator.serviceWorker.ready).pushManager.getSubscription();s&&await s.unsubscribe();const n=de();return await fetch(`${X}/push/unsubscribe`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:n})}),console.log("âœ… Unsubscribed from push notifications"),!0}function _e(){const[t,s]=u.useState(!1);return e.jsx(U.div,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},className:"mb-6",children:t?e.jsx("div",{className:"w-24 h-24 rounded-2xl shadow-lg bg-gradient-to-br from-green-500 to-green-600 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-3xl",children:"BF"})}):e.jsx("img",{src:"/logo.png",alt:"Behtarin Forex",className:"w-24 h-24 rounded-2xl shadow-lg object-cover",onError:()=>s(!0)})})}const Fe=({theme:t,icon:s,label:n,description:r,color:a,onClick:i})=>e.jsxs(U.button,{whileTap:{scale:.98},onClick:()=>i(t),className:"w-full p-4 rounded-2xl bg-white/5 border border-white/10 flex items-center gap-4 active:bg-white/10 transition-all",children:[e.jsx("div",{className:`p-3 rounded-xl ${a==="blue"?"bg-blue-500/20":a==="green"?"bg-green-500/20":"bg-yellow-500/20"}`,children:e.jsx(s,{size:24,className:`${a==="blue"?"text-blue-400":a==="green"?"text-green-400":"text-yellow-400"}`})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"text-white font-semibold text-base",children:n}),e.jsx("div",{className:"text-gray-500 text-xs",children:r})]}),e.jsx(ke,{size:20,className:"text-gray-600"})]});function Oe(){const{setTheme:t}=oe(),s=V(),[n,r]=u.useState(!1),[a,i]=u.useState(!1),[m,y]=u.useState(!1);u.useEffect(()=>{(async()=>{const v=q();if(y(v),v){const l=await Me();r(l)}})()},[]);const d=c=>{t(c),s("/dashboard")},g=async()=>{i(!0);try{n?(await De(),r(!1)):(await Be(),r(!0))}catch(c){console.error("Notification error:",c),alert(c.message||"Ø®Ø·Ø§ Ø¯Ø± ØªÙ†Ø¸ÛŒÙ… Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†")}finally{i(!1)}},f=[{id:I.TELEGRAM,label:"Live Trade",description:"Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø²Ù†Ø¯Ù‡ - Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ",icon:W,color:"green"},{id:I.META5,label:"Signal Channel",description:"Ú©Ø§Ù†Ø§Ù„ Ø³ÛŒÚ¯Ù†Ø§Ù„ Ø¨Ù‡ØªØ±ÛŒÙ† ÙØ§Ø±Ú©Ø³",icon:D,color:"blue"}];return e.jsxs("div",{className:"min-h-[100dvh] bg-[#0e1621] flex flex-col pt-[env(safe-area-inset-top)] overflow-y-auto",children:[e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-6 py-8",children:[e.jsx(_e,{}),e.jsxs(U.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-center mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Behtarin Forex"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Ø¨Ù‡ØªØ±ÛŒÙ† ÙØ§Ø±Ú©Ø³"})]}),e.jsxs("div",{className:"w-full max-w-sm space-y-3",children:[f.map((c,v)=>e.jsx(U.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2+v*.1},children:e.jsx(Fe,{theme:c.id,icon:c.icon,label:c.label,description:c.description,color:c.color,onClick:d})},c.id)),e.jsx(U.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4},style:{display:"block"},children:e.jsxs("button",{onClick:m?g:()=>alert("Ø¨Ø±Ø§ÛŒ ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†ØŒ Ø§Ù¾ Ø±Ø§ Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯ (Add to Home Screen)"),disabled:a,className:`w-full p-4 rounded-2xl border flex items-center gap-3 transition-all ${n?"bg-green-500/10 border-green-500/30":m?"bg-white/5 border-white/10":"bg-orange-500/10 border-orange-500/30"}`,children:[e.jsx("div",{className:`p-3 rounded-xl flex-shrink-0 ${n?"bg-green-500/20":m?"bg-gray-500/20":"bg-orange-500/20"}`,children:a?e.jsx(B,{size:24,className:"text-gray-400 animate-spin"}):n?e.jsx(O,{size:24,className:"text-green-400"}):e.jsx(Ne,{size:24,className:m?"text-gray-400":"text-orange-400"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"text-white font-semibold text-base",children:n?"Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† ÙØ¹Ø§Ù„":m?"Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† ØºÛŒØ±ÙØ¹Ø§Ù„":"Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†"}),e.jsx("div",{className:"text-gray-500 text-xs",children:n?"Ø¨Ø±Ø§ÛŒ ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯":m?"Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§ ÙØ¹Ø§Ù„ Ú©Ù†ÛŒØ¯":"Add to Home Screen Ø¨Ø±Ø§ÛŒ ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ"})]}),e.jsx("div",{className:`w-12 h-6 rounded-full transition-all flex-shrink-0 ${n?"bg-green-500":m?"bg-gray-600":"bg-orange-600"} relative`,children:e.jsx("div",{className:`absolute top-0.5 w-5 h-5 rounded-full bg-white transition-all duration-200 ${n?"right-0.5":"right-6"}`})})]})})]})]}),e.jsxs("div",{className:"p-6 pb-[max(1.5rem,env(safe-area-inset-bottom))] flex items-center justify-between",children:[e.jsx("p",{className:"text-gray-600 text-xs",children:"t.me/behtarinforex"}),e.jsx("button",{onClick:()=>s("/admin"),className:"p-2 rounded-lg hover:bg-white/5 transition",children:e.jsx($e,{size:18,className:"text-gray-600"})})]})]})}const Ve="modulepreload",qe=function(t){return"/"+t},Q={},Ye=function(s,n,r){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),y=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));a=Promise.allSettled(n.map(d=>{if(d=qe(d),d in Q)return;Q[d]=!0;const g=d.endsWith(".css"),f=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${f}`))return;const c=document.createElement("link");if(c.rel=g?"stylesheet":Ve,g||(c.as="script"),c.crossOrigin="",c.href=d,y&&c.setAttribute("nonce",y),document.head.appendChild(c),g)return new Promise((v,l)=>{c.addEventListener("load",v),c.addEventListener("error",()=>l(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(m){const y=new Event("vite:preloadError",{cancelable:!0});if(y.payload=m,window.dispatchEvent(y),!y.defaultPrevented)throw m}return a.then(m=>{for(const y of m||[])y.status==="rejected"&&i(y.reason);return s().catch(i)})},He="https://behtarin-forex-backend.onrender.com/api".replace("/api","")||"http://localhost:5000";function xe(){const[t,s]=u.useState([]),[n,r]=u.useState(!1),[a,i]=u.useState(null);u.useEffect(()=>{let d=null;return(async()=>{try{const{io:f}=await Ye(async()=>{const{io:c}=await import("./index-wSuXe0Ee.js");return{io:c}},[]);d=f(He,{transports:["websocket","polling"],reconnection:!0,reconnectionDelay:1e3,reconnectionAttempts:5}),d.on("connect",()=>{console.log("ðŸ”Œ Connected to trade server"),r(!0),d.emit("subscribe")}),d.on("disconnect",()=>{console.log("ðŸ”Œ Disconnected from trade server"),r(!1)}),d.on("trade_update",c=>{console.log("ðŸ“Š Trade update received:",c);const{event:v,data:l}=c,j={id:Date.now(),event:v,data:l,timestamp:new Date().toISOString()};s([j]),We(v)}),d.on("positions",c=>{console.log("ðŸ“Š Positions received:",c.length)}),i(d)}catch(f){console.error("Socket connection error:",f)}})(),()=>{d&&d.disconnect()}},[]);const m=u.useCallback(d=>{s(g=>g.filter(f=>f.id!==d))},[]),y=u.useCallback(()=>{s([])},[]);return{notifications:t,connected:n,dismissNotification:m,clearAll:y}}function We(t){try{const s=window.AudioContext||window.webkitAudioContext,n=new s,r=n.createOscillator(),a=n.createGain();r.connect(a),a.connect(n.destination),t==="position_opened"?(r.frequency.value=800,r.type="sine"):t==="position_closed"?(r.frequency.value=600,r.type="triangle"):(r.frequency.value=500,r.type="sine"),a.gain.setValueAtTime(.3,n.currentTime),a.gain.exponentialRampToValueAtTime(.01,n.currentTime+.3),r.start(n.currentTime),r.stop(n.currentTime+.3)}catch{}}const G="https://behtarin-forex-backend.onrender.com/api";async function ee(){try{const t=await fetch(`${G}/trades/positions`);if(!t.ok)throw new Error("Failed to fetch positions");return await t.json()}catch(t){return console.error("API Error:",t),[]}}async function Xe(){try{const t=await fetch(`${G}/telegram/channel`);if(!t.ok)throw new Error("Failed to fetch channel info");return await t.json()}catch(t){return console.error("API Error:",t),null}}async function Ge(t=20){try{const s=await fetch(`${G}/telegram/messages?limit=${t}`);if(!s.ok)throw new Error("Failed to fetch messages");return(await s.json()).messages||[]}catch(s){return console.error("API Error:",s),[]}}function ue(t){const s=(t==null?void 0:t.toUpperCase())||"";return s.includes("XAU")?.1:s.includes("JPY")?.01:1e-4}function Je(t,s,n,r=60){const a=ue(t);return(n==null?void 0:n.toUpperCase().includes("BUY"))?s-r*a:s+r*a}function Ke(t,s,n,r=150){const a=ue(t);return(n==null?void 0:n.toUpperCase().includes("BUY"))?s+r*a:s-r*a}function Ze(t){const s=(t==null?void 0:t.toUpperCase())||"";return s.includes("XAU")?2:s.includes("JPY")?3:5}function z(t,s){const n=Ze(t);return(s==null?void 0:s.toFixed(n))||"---"}function Qe(){const t=V(),{notifications:s}=xe(),[n,r]=u.useState(()=>{try{const l=localStorage.getItem("behtarin_signals");return l?JSON.parse(l):{}}catch{return{}}}),[a,i]=u.useState([]),m=u.useRef(null),y=u.useRef(new Set),d=u.useRef([]),g=u.useRef(new Map);u.useEffect(()=>{try{localStorage.setItem("behtarin_signals",JSON.stringify(n))}catch(l){console.error("Error saving signals:",l)}},[n]);const f=async()=>{const l=await ee();!l||l.length===0||r(j=>{const b={...j};let N=!1;return l.forEach(x=>{var h,p;const o=x.magic||x.comment||((h=x.id)==null?void 0:h.toString().slice(-8));if(!b[o]){const k=(p=x.type)==null?void 0:p.includes("BUY");b[o]={id:o,symbol:x.symbol,type:k?"buy":"sell",isBuy:k,openPrice:x.openPrice,volume:x.volume,openTime:x.time||Date.now(),status:"active",actions:[],liveProfit:x.profit||0,livePrice:x.currentPrice,liveVolume:x.volume},N=!0,console.log("ðŸ“Š Synced position:",o,x.symbol)}}),N?b:j})};u.useEffect(()=>{f()},[]),u.useEffect(()=>{const l=()=>{document.visibilityState==="visible"&&(console.log("ðŸ“± App visible - syncing positions..."),f())};return document.addEventListener("visibilitychange",l),()=>document.removeEventListener("visibilitychange",l)},[]),u.useEffect(()=>{const l=async()=>{const b=await ee();if(b){const N=new Map;b.forEach(x=>{var h,p;const o=x.magic||x.comment||((h=x.id)==null?void 0:h.toString().slice(-8));N.set(o,{fullId:((p=x.id)==null?void 0:p.toString())||"",volume:x.volume,profit:x.profit,price:x.currentPrice})}),b.forEach(x=>{var k,C;const o=x.magic||x.comment||((k=x.id)==null?void 0:k.toString().slice(-8)),h=((C=x.id)==null?void 0:C.toString())||"",p=g.current.get(o);if(p&&p.volume>x.volume+.001){const T=p.volume-x.volume,$=T.toFixed(2),w=x.volume,A=d.current.findIndex(P=>{const R=P.positionId===h||P.positionId.endsWith(o)||h.endsWith(P.positionId.slice(-8)),M=Math.abs(P.volume-T)<.005,_=Date.now()-P.timestamp<15e3;return R&&M&&_});let E,L;A!==-1?(E=d.current[A].profit,L=d.current[A].price,console.log("âœ… Using WebSocket profit:",E.toFixed(2)),d.current.splice(A,1)):(E=(p.volume>0?(p.profit||0)/p.volume:0)*T,L=x.currentPrice,console.log("âš ï¸ Using calculated profit:",E.toFixed(2),"(no matching deal found)")),console.log("Volume:",p.volume.toFixed(2),"â†’",x.volume.toFixed(2),"| Profit:",E.toFixed(2)),r(P=>P[o]?{...P,[o]:{...P[o],actions:[...P[o].actions||[],{type:"partial_close",closedVolume:$,remainingVolume:w.toFixed(2),profit:E,price:L,timestamp:new Date().toISOString()}]}}:P)}r(T=>T[o]?{...T,[o]:{...T[o],livePrice:x.currentPrice,liveProfit:x.profit,liveVolume:x.volume}}:T)}),g.current.size>0&&g.current.forEach((x,o)=>{if(!N.has(o)){console.log("Position fully closed:",o);const h=d.current.findIndex(C=>{const T=C.positionId.endsWith(o)||o.endsWith(C.positionId.slice(-8)),$=Date.now()-C.timestamp<15e3;return T&&$});let p=x.profit||0,k=x.price;h!==-1?(p=d.current[h].profit,k=d.current[h].price,console.log("âœ… Using WebSocket profit for close:",p.toFixed(2)),d.current.splice(h,1)):console.log("âš ï¸ Using last known profit for close:",p.toFixed(2)),r(C=>{var A;if(!C[o]||C[o].status==="closed")return C;const T=C[o].actions||[],$=T.reduce((E,L)=>E+(L.profit||0),0),w=$+p;return console.log("Total P/L calculation:",$.toFixed(2),"+",p.toFixed(2),"=",w.toFixed(2)),{...C,[o]:{...C[o],status:"closed",closePrice:k,closeProfit:w,closeTime:new Date().toISOString(),actions:[...T,{type:"closed",price:k,profit:p,volume:(A=x.volume)==null?void 0:A.toFixed(2),timestamp:new Date().toISOString()}]}}})}}),g.current=N,i(b)}};l();const j=setInterval(l,2e3);return()=>clearInterval(j)},[]),u.useEffect(()=>{var l,j,b,N,x,o,h,p,k,C,T,$;if(s.length>0){const w=s[0],A=`${w.event}-${(l=w.data)==null?void 0:l.id}-${w.timestamp}`;if(y.current.has(A))return;y.current.add(A);const E=((j=w.data)==null?void 0:j.magic)||((b=w.data)==null?void 0:b.comment)||((x=(N=w.data)==null?void 0:N.id)==null?void 0:x.toString().slice(-8))||"Unknown";if(w.event==="position_opened"){const L=(h=(o=w.data)==null?void 0:o.type)==null?void 0:h.includes("BUY");r(P=>{var R,M,_,J,K;return{...P,[E]:{id:E,symbol:(R=w.data)==null?void 0:R.symbol,type:L?"buy":"sell",isBuy:L,openPrice:(M=w.data)==null?void 0:M.openPrice,volume:(_=w.data)==null?void 0:_.volume,openTime:w.timestamp,status:"active",actions:[],liveProfit:0,livePrice:(J=w.data)==null?void 0:J.openPrice,liveVolume:(K=w.data)==null?void 0:K.volume}}})}else if(w.event==="deal_closed"){const L=((k=(p=w.data)==null?void 0:p.positionId)==null?void 0:k.toString())||"",P=((C=w.data)==null?void 0:C.profit)||0,R=((T=w.data)==null?void 0:T.volume)||0,M=($=w.data)==null?void 0:$.price;console.log("Deal closed:",{positionId:L,profit:P,volume:R}),d.current.push({positionId:L,profit:P,volume:R,price:M,timestamp:Date.now()}),d.current.length>20&&(d.current=d.current.slice(-20))}else w.event==="position_closed"&&console.log("Ignoring position_closed")}},[s]),u.useEffect(()=>{var l;(l=m.current)==null||l.scrollIntoView({behavior:"smooth"})},[n]);const c=a.map(l=>{var j,b;return{code:l.magic||l.comment||((j=l.id)==null?void 0:j.toString().slice(-8)),symbol:l.symbol,type:(b=l.type)!=null&&b.includes("BUY")?"BUY":"SELL",volume:l.volume,profit:l.profit}}),v=Object.values(n).sort((l,j)=>new Date(l.openTime)-new Date(j.openTime));return e.jsxs("div",{className:"h-screen flex flex-col bg-[#0e1621] safe-top",children:[e.jsxs("div",{className:"bg-[#17212b] text-white p-3 pt-[max(0.75rem,env(safe-area-inset-top))] flex items-center justify-between shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>t("/login"),className:"p-1 hover:bg-white/10 rounded-lg transition",children:e.jsx(H,{size:22,className:"text-gray-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-[15px]",children:"ðŸ“Š Signal Tracker"}),e.jsxs("div",{className:"text-[11px] text-gray-400",children:[c.length," Ø³ÛŒÚ¯Ù†Ø§Ù„ ÙØ¹Ø§Ù„"]})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx(Te,{size:20,className:"text-gray-400"})})]}),c.length>0&&e.jsx("div",{className:"bg-[#1c2733] px-3 py-2 flex gap-2 overflow-x-auto border-b border-[#0e1621]",children:c.map((l,j)=>{var b;return e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full text-xs whitespace-nowrap ${l.type==="BUY"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:[e.jsx("span",{className:"font-mono font-bold",children:l.code}),e.jsx("span",{children:l.symbol}),e.jsxs("span",{className:"text-gray-400",children:[l.volume,"lot"]}),e.jsxs("span",{className:l.profit>=0?"text-green-400":"text-red-400",children:[l.profit>=0?"+":"",(b=l.profit)==null?void 0:b.toFixed(1),"$"]})]},j)})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-[#182533] text-gray-400 text-[11px] px-3 py-1 rounded-full",children:"Ø§Ù…Ø±ÙˆØ²"})}),v.length===0&&e.jsx("div",{className:"flex justify-center mt-10",children:e.jsxs("div",{className:"bg-[#182533] text-gray-400 text-sm px-4 py-3 rounded-xl text-center",children:[e.jsx(O,{size:32,className:"mx-auto mb-2 opacity-50"}),e.jsx("div",{children:"Ù…Ù†ØªØ¸Ø± Ø³ÛŒÚ¯Ù†Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯..."})]})}),e.jsx(ne,{children:v.map(l=>e.jsx(U.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},className:"flex justify-start",children:e.jsx(et,{signal:l})},l.id))}),e.jsx("div",{ref:m})]}),e.jsx("div",{className:"bg-[#17212b] border-t border-[#0e1621] p-3 pb-[max(0.75rem,env(safe-area-inset-bottom))]",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{children:"Ù…ØªØµÙ„ Ø¨Ù‡ MetaTrader"})]}),e.jsx("span",{children:"t.me/behtarinforex"})]})})]})}function et({signal:t}){const{id:s,symbol:n,type:r,isBuy:a,openPrice:i,volume:m,openTime:y,status:d,actions:g,liveProfit:f,livePrice:c,closeProfit:v}=t,l=o=>o!=null&&o.includes("XAU")?"Gold":o!=null&&o.includes("XAG")?"Silver":o,j=a?"bg-gradient-to-br from-green-900/40 to-green-800/20 border-green-500/30":"bg-gradient-to-br from-red-900/40 to-red-800/20 border-red-500/30",b=d==="closed"?v:f,N=b>=0,x=g&&g.length>0;return e.jsxs("div",{dir:"ltr",className:`w-[280px] rounded-2xl rounded-tl-md border ${j} overflow-hidden`,children:[e.jsx("div",{className:"px-3 py-2 border-b border-white/10",children:e.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap text-left",children:[e.jsx("span",{className:`text-base ${a?"text-green-500":"text-red-500"}`,children:a?"ðŸŸ¢":"ðŸ”´"}),e.jsx("span",{className:"text-white font-bold",children:l(n)}),e.jsx("span",{className:`font-bold text-sm ${a?"text-green-400":"text-red-400"}`,children:a?"Buy":"Sell"}),e.jsxs("span",{className:"text-gray-400 text-sm",children:["(",z(n,i),")"]}),e.jsxs("span",{className:"text-yellow-500 font-mono text-xs",children:["#",s]})]})}),e.jsxs("div",{className:"px-3 py-1.5 flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400 text-xs",children:"Volume"}),e.jsxs("span",{className:"font-mono text-white text-sm",children:[m," lot"]})]}),b!=null&&e.jsx("div",{className:"px-3 py-1.5 border-t border-white/5",children:e.jsxs("div",{className:`flex justify-between items-center px-2 py-1.5 rounded-lg ${N?"bg-green-500/20":"bg-red-500/20"}`,children:[e.jsx("span",{className:"text-gray-300 text-xs",children:"P/L"}),e.jsxs("span",{className:`font-mono font-bold ${N?"text-green-400":"text-red-400"}`,children:[N?"+":"",b==null?void 0:b.toFixed(2),"$"]})]})}),x&&e.jsx("div",{className:"border-t border-white/10",children:g.map((o,h)=>e.jsx(tt,{action:o,symbol:n,signalCloseProfit:t.closeProfit},h))}),e.jsxs("div",{className:"px-3 py-1 flex justify-between items-center border-t border-white/5",children:[e.jsxs("span",{className:`text-[10px] ${d==="closed"?"text-gray-500":"text-green-400"}`,children:["â— ",d==="closed"?"Closed":"Active"]}),e.jsx("span",{className:"text-[10px] text-gray-500",children:new Date(y).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]})]})}function tt({action:t,symbol:s,signalCloseProfit:n}){const{type:r,closedVolume:a,remainingVolume:i,profit:m,price:y,timestamp:d}=t,g=(m??0)>=0;if(r==="partial_close")return e.jsxs("div",{className:"px-3 py-2 bg-yellow-500/10 border-b border-yellow-500/20",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-yellow-400",children:"ðŸ“¦"}),e.jsx("span",{className:"text-gray-300",children:"Partial Close"})]}),e.jsx("span",{className:"text-gray-500 text-[10px]",children:new Date(d).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[e.jsxs("span",{className:"text-red-400",children:["-",a," lot"]}),e.jsx("span",{className:"text-gray-500",children:"â†’"}),e.jsxs("span",{className:"text-green-400",children:[i," lot"]})]}),e.jsxs("span",{className:`font-mono font-bold text-xs ${g?"text-green-400":"text-red-400"}`,children:[g?"+":"",m==null?void 0:m.toFixed(2),"$"]})]})]});if(r==="closed"){const f=n??m??0,c=f>=0;return e.jsxs("div",{className:"px-3 py-2 bg-gray-500/10 border-b border-gray-500/20",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-400",children:"âœ…"}),e.jsx("span",{className:"text-gray-300",children:"Fully Closed"}),e.jsxs("span",{className:"text-gray-500",children:["(",z(s,y),")"]})]}),e.jsx("span",{className:"text-gray-500 text-[10px]",children:new Date(d).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("div",{className:"flex items-center justify-end mt-1",children:e.jsxs("span",{className:`font-mono font-bold text-sm ${c?"text-green-400":"text-red-400"}`,children:["Total P/L: ",c?"+":"",f==null?void 0:f.toFixed(2),"$"]})})]})}return null}function st({post:t,onReplyClick:s,isHighlighted:n}){const r=t.replyTo&&t.replyTo.text;return e.jsxs("div",{id:`msg-${t.id}`,className:`bg-[#182533] rounded-xl overflow-hidden transition-all duration-500 ${r?"border-l-4 border-l-blue-500 border border-blue-500/20":"border border-white/5"} ${n?"ring-2 ring-yellow-500 bg-yellow-500/10":""}`,children:[r&&e.jsxs("div",{className:"px-3 py-2 bg-blue-500/10 border-b border-blue-500/20 cursor-pointer hover:bg-blue-500/20 transition-colors active:bg-blue-500/30 flex items-start gap-2",onClick:()=>s(t.replyTo.id),children:[e.jsx(Ue,{size:14,className:"text-blue-400 rotate-180 flex-shrink-0 mt-1"}),e.jsx("div",{className:"flex-1 min-w-0 bg-[#0e1621] rounded px-2 py-1.5 border-l-2 border-blue-400",children:e.jsx("p",{className:"text-xs text-gray-400 line-clamp-4 leading-relaxed",dir:"auto",children:t.replyTo.text})}),e.jsx("span",{className:"text-[10px] text-blue-400 flex-shrink-0 mt-1",children:"â†©ï¸"})]}),e.jsx("div",{className:"p-4",children:e.jsx("pre",{className:"text-gray-200 text-sm whitespace-pre-wrap font-sans leading-relaxed",dir:"auto",children:t.text})}),(t.time||t.views)&&e.jsxs("div",{className:"px-4 py-2 border-t border-white/5 flex items-center justify-between text-xs text-gray-500",children:[e.jsx("span",{children:t.time}),t.views&&e.jsxs("span",{children:["ðŸ‘ ",t.views]})]})]})}function rt(){const t=V(),[s,n]=u.useState([]),[r,a]=u.useState(null),[i,m]=u.useState(!0),[y,d]=u.useState(!1),[g,f]=u.useState(!1),[c,v]=u.useState(null),l=u.useRef(null),j=u.useRef(null),b=()=>{var h;(h=j.current)==null||h.scrollIntoView({behavior:"smooth"})},N=u.useCallback(h=>{if(!h)return;const p=document.getElementById(`msg-${h}`);p&&(p.scrollIntoView({behavior:"smooth",block:"center"}),v(h),setTimeout(()=>v(null),2e3))},[]),x=()=>{if(l.current){const{scrollTop:h,scrollHeight:p,clientHeight:k}=l.current;f(p-h-k>100)}},o=async(h=!1)=>{h?m(!0):d(!0);try{const[p,k]=await Promise.all([Ge(30),Xe()]);p&&p.length>0&&(n(p),h&&setTimeout(b,150)),k&&a(k)}catch(p){console.error("Error:",p)}finally{m(!1),d(!1)}};return u.useEffect(()=>{o(!0);const h=setInterval(()=>o(!1),5e3);return()=>clearInterval(h)},[]),e.jsxs("div",{className:"h-screen flex flex-col bg-[#0e1621] safe-top relative",children:[e.jsxs("div",{className:"bg-[#17212b] text-white p-3 pt-[max(0.75rem,env(safe-area-inset-top))] flex items-center justify-between shadow-lg z-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>t("/login"),className:"p-1 hover:bg-white/10 rounded-lg transition",children:e.jsx(H,{size:22,className:"text-gray-400"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center",children:e.jsx(D,{size:18,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-[15px]",children:(r==null?void 0:r.title)||"Signal Channel"}),e.jsxs("div",{className:"text-[11px] text-gray-400 flex items-center gap-2",children:[e.jsxs("span",{children:["@",(r==null?void 0:r.username)||"behtarinforex"]}),(r==null?void 0:r.memberCount)>0&&e.jsxs("span",{className:"text-blue-400",children:["â€¢ ",r.memberCount.toLocaleString()," Ø¹Ø¶Ùˆ"]})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>o(!1),disabled:y,className:"p-2 hover:bg-white/10 rounded-full transition disabled:opacity-50",children:y?e.jsx(B,{size:18,className:"text-gray-400 animate-spin"}):e.jsx(Ae,{size:18,className:"text-gray-400"})}),e.jsx("a",{href:`https://t.me/${(r==null?void 0:r.username)||"behtarinforex"}`,target:"_blank",rel:"noopener noreferrer",className:"bg-blue-500 text-white text-xs px-3 py-1.5 rounded-full hover:bg-blue-600",children:"Join"})]})]}),e.jsx("div",{ref:l,onScroll:x,className:"flex-1 overflow-y-auto p-3 space-y-3",children:i?e.jsx("div",{className:"flex items-center justify-center py-10",children:e.jsx(B,{size:32,className:"text-blue-400 animate-spin"})}):s.length===0?e.jsx("div",{className:"text-center text-gray-500 py-10",children:"Ù‡ÛŒÚ† Ù¾ÛŒØ§Ù…ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-center py-2",children:e.jsx("a",{href:`https://t.me/${(r==null?void 0:r.username)||"behtarinforex"}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 text-xs hover:underline",children:"â† Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒâ€ŒØªØ± Ø¯Ø± ØªÙ„Ú¯Ø±Ø§Ù…"})}),s.map((h,p)=>e.jsx(U.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:p*.01},children:e.jsx(st,{post:h,onReplyClick:N,isHighlighted:c===h.id})},h.id)),e.jsx("div",{ref:j})]})}),g&&e.jsx("button",{onClick:b,className:"absolute bottom-24 right-4 p-3 bg-[#17212b] border border-white/10 rounded-full shadow-lg hover:bg-[#1c2733] transition z-20",children:e.jsx(we,{size:20,className:"text-gray-400"})}),e.jsx("div",{className:"bg-[#17212b] border-t border-[#0e1621] p-3 pb-[max(0.75rem,env(safe-area-inset-bottom))]",children:e.jsxs("a",{href:`https://t.me/${(r==null?void 0:r.username)||"behtarinforex"}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl py-3 text-white font-medium",children:[e.jsx(D,{size:18}),e.jsx("span",{children:"Ø¹Ø¶ÙˆÛŒØª Ø¯Ø± Ú©Ø§Ù†Ø§Ù„"})]})})]})}function nt(){const{theme:t}=oe();return e.jsx("div",{className:"bg-[#0e1621] min-h-screen w-full flex justify-center items-start",children:e.jsxs("div",{className:"min-h-screen w-full max-w-lg mx-auto overflow-hidden bg-[#0e1621]",children:[t===I.TELEGRAM&&e.jsx(Qe,{}),t===I.META5&&e.jsx(rt,{})]})})}const te="https://behtarin-forex-backend.onrender.com/api";function it(){const t=V(),[s,n]=u.useState("signal"),[r,a]=u.useState(""),[i,m]=u.useState(!1),[y,d]=u.useState(!1),[g,f]=u.useState(null),[c,v]=u.useState({symbol:"XAUUSD",tradeType:"buy",entries:"",stopLoss:"",targets:""}),[l,j]=u.useState(""),b=o=>{o.preventDefault(),r.length>0&&m(!0)},N=async()=>{d(!0),f(null);try{const h=await(await fetch(`${te}/telegram/send-signal`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...c,password:r})})).json();h.success?(f({type:"success",text:"Ø³ÛŒÚ¯Ù†Ø§Ù„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯ âœ…"}),v({symbol:"XAUUSD",tradeType:"buy",entries:"",stopLoss:"",targets:""})):f({type:"error",text:h.error||"Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„"})}catch{f({type:"error",text:"Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±"})}finally{d(!1)}},x=async()=>{d(!0),f(null);try{const h=await(await fetch(`${te}/telegram/send`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:l,password:r})})).json();h.success?(f({type:"success",text:"Ù¾ÛŒØ§Ù… Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯ âœ…"}),j("")):f({type:"error",text:h.error||"Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„"})}catch{f({type:"error",text:"Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ±"})}finally{d(!1)}};return i?e.jsxs("div",{className:"min-h-screen bg-[#0e1621] safe-top",children:[e.jsx("div",{className:"bg-[#17212b] text-white p-3 pt-[max(0.75rem,env(safe-area-inset-top))] flex items-center justify-between shadow-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>t("/login"),className:"p-1 hover:bg-white/10 rounded-lg transition",children:e.jsx(H,{size:22,className:"text-gray-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-[15px]",children:"ðŸ” Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª"}),e.jsx("div",{className:"text-[11px] text-gray-400",children:"Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø¨Ù‡ Ú©Ø§Ù†Ø§Ù„"})]})]})}),e.jsxs("div",{className:"flex border-b border-white/10",children:[e.jsxs("button",{onClick:()=>n("signal"),className:`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition ${s==="signal"?"text-blue-400 border-b-2 border-blue-400":"text-gray-500"}`,children:[e.jsx(Re,{size:16})," Ø³ÛŒÚ¯Ù†Ø§Ù„"]}),e.jsxs("button",{onClick:()=>n("message"),className:`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition ${s==="message"?"text-blue-400 border-b-2 border-blue-400":"text-gray-500"}`,children:[e.jsx(Le,{size:16})," Ù¾ÛŒØ§Ù…"]})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[g&&e.jsxs(U.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:`p-3 rounded-xl flex items-center gap-2 ${g.type==="success"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:[g.type==="success"?e.jsx(Se,{size:18}):e.jsx(ce,{size:18}),e.jsx("span",{className:"text-sm",children:g.text})]}),s==="signal"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-xs mb-1 block",children:"Ù†Ù…Ø§Ø¯"}),e.jsxs("select",{value:c.symbol,onChange:o=>v({...c,symbol:o.target.value}),className:"w-full bg-[#17212b] border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-blue-500",children:[e.jsx("option",{value:"XAUUSD",children:"XAUUSD (Ø·Ù„Ø§)"}),e.jsx("option",{value:"EURUSD",children:"EURUSD (ÛŒÙˆØ±Ùˆ/Ø¯Ù„Ø§Ø±)"}),e.jsx("option",{value:"GBPUSD",children:"GBPUSD (Ù¾ÙˆÙ†Ø¯/Ø¯Ù„Ø§Ø±)"}),e.jsx("option",{value:"XAGUSD",children:"XAGUSD (Ù†Ù‚Ø±Ù‡)"}),e.jsx("option",{value:"USDJPY",children:"USDJPY (Ø¯Ù„Ø§Ø±/ÛŒÙ†)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-xs mb-1 block",children:"Ù†ÙˆØ¹ Ù…Ø¹Ø§Ù…Ù„Ù‡"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>v({...c,tradeType:"buy"}),className:`flex-1 py-3 rounded-xl font-medium flex items-center justify-center gap-2 transition ${c.tradeType==="buy"?"bg-green-500 text-white":"bg-[#17212b] text-gray-400 border border-white/10"}`,children:[e.jsx(W,{size:18})," Ø®Ø±ÛŒØ¯ (BUY)"]}),e.jsxs("button",{onClick:()=>v({...c,tradeType:"sell"}),className:`flex-1 py-3 rounded-xl font-medium flex items-center justify-center gap-2 transition ${c.tradeType==="sell"?"bg-red-500 text-white":"bg-[#17212b] text-gray-400 border border-white/10"}`,children:[e.jsx(le,{size:18})," ÙØ±ÙˆØ´ (SELL)"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-xs mb-1 block",children:"Ù†Ù‚Ø§Ø· ÙˆØ±ÙˆØ¯"}),e.jsx("input",{type:"text",value:c.entries,onChange:o=>v({...c,entries:o.target.value}),placeholder:"Ù…Ø«Ø§Ù„: 2650 Ùˆ 2648",className:"w-full bg-[#17212b] border border-white/10 rounded-xl px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-blue-500",dir:"ltr"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-xs mb-1 block",children:"Ø§Ø³ØªØ§Ù¾ Ù„Ø§Ø³"}),e.jsx("input",{type:"text",value:c.stopLoss,onChange:o=>v({...c,stopLoss:o.target.value}),placeholder:"Ù…Ø«Ø§Ù„: 2645",className:"w-full bg-[#17212b] border border-white/10 rounded-xl px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-blue-500",dir:"ltr"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-xs mb-1 block",children:"ØªØ§Ø±Ú¯Øªâ€ŒÙ‡Ø§ (Ø¨Ø§ Ú©Ø§Ù…Ø§ Ø¬Ø¯Ø§ Ú©Ù†ÛŒØ¯)"}),e.jsx("input",{type:"text",value:c.targets,onChange:o=>v({...c,targets:o.target.value}),placeholder:"Ù…Ø«Ø§Ù„: 2655, 2660, 2665, 2670",className:"w-full bg-[#17212b] border border-white/10 rounded-xl px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-blue-500",dir:"ltr"})]}),e.jsx("button",{onClick:N,disabled:y||!c.entries||!c.stopLoss||!c.targets,className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 disabled:opacity-50 text-white font-medium py-4 rounded-xl transition flex items-center justify-center gap-2",children:y?e.jsx(B,{size:20,className:"animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(D,{size:18})," Ø§Ø±Ø³Ø§Ù„ Ø³ÛŒÚ¯Ù†Ø§Ù„"]})})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-xs mb-1 block",children:"Ù…ØªÙ† Ù¾ÛŒØ§Ù…"}),e.jsx("textarea",{value:l,onChange:o=>j(o.target.value),placeholder:"Ù…ØªÙ† Ù¾ÛŒØ§Ù… Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯...",rows:6,className:"w-full bg-[#17212b] border border-white/10 rounded-xl px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-blue-500 resize-none",dir:"rtl"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-xs mb-2 block",children:"Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø³Ø±ÛŒØ¹"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["âœ… ØªØ§Ø±Ú¯Øª Û± Ø²Ø¯Ù‡ Ø´Ø¯!","âœ… ØªØ§Ø±Ú¯Øª Û² Ø²Ø¯Ù‡ Ø´Ø¯!","âŒ Ø§Ø³ØªØ§Ù¾ Ø²Ø¯Ù‡ Ø´Ø¯","ðŸ“Š Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ Ø¨Ø§Ø²Ø§Ø±...","ðŸ”’ Ø§Ø³ØªØ§Ù¾ Ø¨Ù‡ ÙˆØ±ÙˆØ¯ Ù…Ù†ØªÙ‚Ù„ Ø´Ø¯"].map(o=>e.jsx("button",{onClick:()=>j(l+(l?`
`:"")+o),className:"px-3 py-1.5 bg-[#17212b] border border-white/10 rounded-lg text-xs text-gray-300 hover:bg-white/5",children:o},o))})]}),e.jsx("button",{onClick:x,disabled:y||!l.trim(),className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 disabled:opacity-50 text-white font-medium py-4 rounded-xl transition flex items-center justify-center gap-2",children:y?e.jsx(B,{size:20,className:"animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(D,{size:18})," Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù…"]})})]})]})]}):e.jsx("div",{className:"min-h-screen bg-[#0e1621] flex flex-col items-center justify-center p-6",children:e.jsxs(U.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-sm",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-500/20 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(Ee,{size:32,className:"text-blue-400"})}),e.jsx("h1",{className:"text-white text-xl font-bold",children:"Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯"})]}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsx("input",{type:"password",value:r,onChange:o=>a(o.target.value),placeholder:"Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±",className:"w-full bg-[#17212b] border border-white/10 rounded-xl px-4 py-3 text-white placeholder-gray-500 focus:outline-none focus:border-blue-500",dir:"ltr"}),e.jsx("button",{type:"submit",className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-medium py-3 rounded-xl transition",children:"ÙˆØ±ÙˆØ¯"})]}),e.jsx("button",{onClick:()=>t("/login"),className:"w-full mt-4 text-gray-500 text-sm hover:text-gray-400",children:"Ø¨Ø§Ø²Ú¯Ø´Øª"})]})})}const se=60,re=150;function ot({notifications:t,onDismiss:s}){return e.jsx("div",{className:"fixed top-4 right-4 z-[100] space-y-2 max-w-sm w-full pointer-events-none",children:e.jsx(ne,{children:t.map(n=>e.jsx(U.div,{initial:{opacity:0,x:100,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:100,scale:.8},className:"pointer-events-auto",children:e.jsx(at,{notification:n,onDismiss:s})},n.id))})})}function at({notification:t,onDismiss:s}){var b,N;const{id:n,type:r,event:a,data:i,timestamp:m}=t,d=(()=>{var x,o;switch(a){case"position_opened":return{icon:(x=i.type)!=null&&x.includes("BUY")?W:le,color:(o=i.type)!=null&&o.includes("BUY")?"green":"red",title:"ðŸš€ Ù…Ø¹Ø§Ù…Ù„Ù‡ Ø¬Ø¯ÛŒØ¯ Ø¨Ø§Ø² Ø´Ø¯!",titleEn:"New Position Opened!"};case"position_closed":return{icon:Ce,color:i.profit>=0?"green":"red",title:i.profit>=0?"âœ… Ù…Ø¹Ø§Ù…Ù„Ù‡ Ø¨Ø§ Ø³ÙˆØ¯ Ø¨Ø³ØªÙ‡ Ø´Ø¯!":"âŒ Ù…Ø¹Ø§Ù…Ù„Ù‡ Ø¨Ø§ Ø¶Ø±Ø± Ø¨Ø³ØªÙ‡ Ø´Ø¯!",titleEn:i.profit>=0?"Position Closed (Profit)":"Position Closed (Loss)"};case"position_updated":return{icon:Pe,color:"yellow",title:"ðŸ“ Ù…Ø¹Ø§Ù…Ù„Ù‡ Ø¢Ù¾Ø¯ÛŒØª Ø´Ø¯",titleEn:"Position Updated"};case"order_placed":return{icon:O,color:"blue",title:"ðŸ“‹ Ø³ÙØ§Ø±Ø´ Ø«Ø¨Øª Ø´Ø¯",titleEn:"Order Placed"};default:return{icon:O,color:"gray",title:"Trade Update",titleEn:"Trade Update"}}})(),g=d.icon,f=(b=i.type)==null?void 0:b.includes("BUY"),c=parseFloat(i.openPrice)||0,v=i.stopLoss||Je(i.symbol,c,i.type,se),l=i.takeProfit||Ke(i.symbol,c,i.type,re),j={green:"bg-green-500/10 border-green-500/30 text-green-500",red:"bg-red-500/10 border-red-500/30 text-red-500",yellow:"bg-yellow-500/10 border-yellow-500/30 text-yellow-500",blue:"bg-blue-500/10 border-blue-500/30 text-blue-500",gray:"bg-gray-500/10 border-gray-500/30 text-gray-500"};return e.jsxs("div",{className:`bg-[#1a1a1a] border ${j[d.color].split(" ")[1]} rounded-xl shadow-2xl overflow-hidden backdrop-blur-lg`,children:[e.jsxs("div",{className:`px-4 py-2 flex items-center justify-between ${j[d.color].split(" ")[0]}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{size:18,className:j[d.color].split(" ")[2]}),e.jsx("span",{className:"font-bold text-sm text-white",children:d.title})]}),e.jsx("button",{onClick:()=>s(n),className:"p-1 hover:bg-white/10 rounded transition",children:e.jsx(ce,{size:14,className:"text-gray-400"})})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-xl text-white",children:i.symbol}),e.jsx("span",{className:`text-xs font-bold px-2 py-0.5 rounded ${f?"bg-green-500/20 text-green-500":"bg-red-500/20 text-red-500"}`,children:f?"BUY":"SELL"})]}),i.volume&&e.jsxs("span",{className:"text-sm text-gray-400 font-mono",children:[i.volume," lot"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-black/40 rounded-lg p-2 border border-white/10",children:[e.jsx("div",{className:"text-gray-400 text-[10px] uppercase mb-1",children:"Entry"}),e.jsx("div",{className:"font-mono text-white font-bold",children:z(i.symbol,c)})]}),e.jsxs("div",{className:"bg-red-500/10 rounded-lg p-2 border border-red-500/20",children:[e.jsxs("div",{className:"text-red-400 text-[10px] uppercase mb-1 flex items-center justify-between",children:[e.jsx("span",{children:"SL"}),e.jsxs("span",{className:"text-[8px] text-red-300",children:[se," pip"]})]}),e.jsx("div",{className:"font-mono text-red-400 font-bold",children:z(i.symbol,v)})]}),e.jsxs("div",{className:"bg-green-500/10 rounded-lg p-2 border border-green-500/20",children:[e.jsxs("div",{className:"text-green-400 text-[10px] uppercase mb-1 flex items-center justify-between",children:[e.jsx("span",{children:"TP"}),e.jsxs("span",{className:"text-[8px] text-green-300",children:[re," pip"]})]}),e.jsx("div",{className:"font-mono text-green-400 font-bold",children:z(i.symbol,l)})]})]}),i.profit!==void 0&&e.jsxs("div",{className:`text-center py-2 rounded-lg ${i.profit>=0?"bg-green-500/20":"bg-red-500/20"}`,children:[i.currentPrice&&e.jsxs("div",{className:"text-xs text-gray-400 mb-1",children:["Current: ",e.jsx("span",{className:"text-yellow-500 font-mono",children:z(i.symbol,i.currentPrice)})]}),e.jsxs("span",{className:`font-mono font-bold text-lg ${i.profit>=0?"text-green-500":"text-red-500"}`,children:[i.profit>=0?"+":"",(N=i.profit)==null?void 0:N.toFixed(2),"$"]})]}),e.jsx("div",{className:"text-[10px] text-gray-500 text-right",children:new Date(m).toLocaleTimeString("fa-IR")})]})]})}function lt(){const{notifications:t,connected:s,dismissNotification:n}=xe();return e.jsxs("div",{className:"antialiased",children:[e.jsx(ot,{notifications:t,onDismiss:n}),s&&e.jsxs("div",{className:"fixed bottom-4 left-4 z-50 flex items-center gap-2 bg-green-500/20 text-green-500 text-xs px-3 py-1.5 rounded-full border border-green-500/30",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Live Connected"]}),e.jsxs(he,{children:[e.jsx(F,{path:"/login",element:e.jsx(Oe,{})}),e.jsx(F,{path:"/dashboard",element:e.jsx(nt,{})}),e.jsx(F,{path:"/admin",element:e.jsx(it,{})}),e.jsx(F,{path:"*",element:e.jsx(pe,{to:"/login",replace:!0})})]})]})}function ct(){return e.jsx(be,{children:e.jsx(lt,{})})}Y.createRoot(document.getElementById("root")).render(e.jsx(fe.StrictMode,{children:e.jsx(ge,{children:e.jsx(ct,{})})}));
